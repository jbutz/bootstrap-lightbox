/*!=========================================================
* bootstrap-lightbox v0.5.0 - 2/27/2013
* http://jbutz.github.com/bootstrap-lightbox/
* HEAVILY based off bootstrap-modal.js
* ==========================================================
* Copyright (c) 2013 Jason Butz (http://jasonbutz.info)
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* ========================================================= */
!function(t){"use strict";var e=function(e,i){this.options=i,this.$element=t(e).delegate('[data-dismiss="lightbox"]',"click.dismiss.lightbox",t.proxy(this.hide,this)),this.options.remote&&this.$element.find(".lightbox-body").load(this.options.remote),this.cloneSize()};e.prototype={constructor:e,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var e=this,i=t.Event("show");this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var i=t.support.transition&&e.$element.hasClass("fade");e.$element.parent().length||e.$element.appendTo(document.body),e.$element.show(),i&&e.$element[0].offsetWidth,e.$element.addClass("in").attr("aria-hidden",!1),e.enforceFocus(),i?e.$element.one(t.support.transition.end,function(){e.centerImage(),e.$element.focus().trigger("shown")}):function(){e.centerImage(),e.$element.focus().trigger("shown")}()}))},hide:function(e){e&&e.preventDefault(),e=t.Event("hide"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),t(document).off("focusin.lightbox"),this.$element.removeClass("in").attr("aria-hidden",!0),t.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideLightbox())},enforceFocus:function(){var e=this;t(document).on("focusin.lightbox",function(t){e.$element[0]===t.target||e.$element.has(t.target).length||e.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keypress.dismiss.lightbox, keyup.dismiss.lightbox",function(e){27==e.which&&t.hide()}):this.isShown||this.$element.off("keypress.dismiss.lightbox, keyup.dismiss.lightbox")},hideWithTransition:function(){var e=this,i=setTimeout(function(){e.$element.off(t.support.transition.end),e.hideLightbox()},500);this.$element.one(t.support.transition.end,function(){clearTimeout(i),e.hideLightbox()})},hideLightbox:function(){this.$element.hide().trigger("hidden"),this.backdrop()},removeBackdrop:function(){this.$backdrop.remove(),this.$backdrop=null},backdrop:function(e){var i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=t.support.transition&&i;this.$backdrop=t('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?t.proxy(this.$element[0].focus,this.$element[0]):t.proxy(this.hide,this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),o?this.$backdrop.one(t.support.transition.end,e):e()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,t.proxy(this.removeBackdrop,this)):this.removeBackdrop()):e&&e()},centerImage:function(){var e,i=this,o=0;if(i.h=i.$element.height(),i.w=i.$element.width(),i.options.resizeToFit){o=10,e=i.$element.find(".lightbox-content").find("img:first"),e.data("osizew")||e.data("osizew",e.width()),e.data("osizeh")||e.data("osizeh",e.height()),e.data("osizew"),e.data("osizeh"),e.css("max-width","none"),e.css("max-height","none");var n=50,s=40;i.$element.find(".lightbox-header").length>0&&(n+=40,s+=10),i.$element.find(".lightbox-footer").length>0&&(s+=i.$element.find(".lightbox-footer").height(),s+=10),e.css("max-width",t(window).width()-n),e.css("max-height",t(window).height()-s),i.w=e.width(),i.h=e.height()}i.$element.css({position:"fixed",left:t(window).width()/2-i.w/2,top:t(window).height()/2-i.h/2-o}),i.enforceFocus()},cloneSize:function(){var e=this;e.$clone=e.$element.filter(":first").clone().css({position:"absolute",top:-2e3,display:"block",visibility:"visible",opacity:100}).removeClass("fade").appendTo("body"),e.h=e.$clone.height(),e.w=e.$clone.width(),e.$clone.remove(),e.$element.css({position:"fixed",left:t(window).width()/2-e.w/2,top:t(window).height()/2-e.h/2})}},t.fn.lightbox=function(i){return this.each(function(){var o=t(this),n=o.data("lightbox"),s=t.extend({},t.fn.lightbox.defaults,o.data(),"object"==typeof i&&i);n||o.data("lightbox",n=new e(this,s)),"string"==typeof i?n[i]():s.show&&n.show()})},t.fn.lightbox.defaults={backdrop:!0,keyboard:!0,show:!0,resizeToFit:!0},t.fn.lightbox.Constructor=e,t(document).on("click.lightbox.data-api",'[data-toggle="lightbox"]',function(e){var i=t(this),o=i.attr("href"),n=t(i.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),s=n.data("lightbox")?"toggle":t.extend({remote:!/#/.test(o)&&o},n.data(),i.data()),h=i.attr("data-image")||!1;e.preventDefault(),h&&(n.data("original-content",n.find(".lightbox-content").html()),n.find(".lightbox-content").html('<img border="0" src="'+h+'" />')),n.lightbox(s).one("hide",function(){i.focus()}).one("hidden",function(){h&&(n.find(".lightbox-content").html(n.data("original-content")),h=void 0)})})}(window.jQuery);